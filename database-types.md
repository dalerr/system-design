# Типы баз данных

## Определение

**База данных** — это организованная коллекция данных, хранящаяся и доступная электронным способом. Существует множество типов баз данных, каждый из которых оптимизирован для определенных use cases.

---

## Классификация баз данных

### По модели данных

1. **Реляционные (SQL)** — таблицы со связями
2. **Нереляционные (NoSQL)** — различные модели данных:
   - Документные
   - Key-Value
   - Колоночные
   - Графовые
   - Временные ряды
   - Поисковые

---

## Реляционные базы данных (SQL)

### Определение

**Реляционная база данных** — это база данных, которая хранит данные в виде таблиц (отношений) со строками и столбцами, связанными между собой.

**Характеристики:**
- ✅ Структурированные данные в таблицах
- ✅ Связи между таблицами (foreign keys)
- ✅ ACID транзакции
- ✅ SQL для запросов
- ✅ Схема данных (schema) фиксирована

**Модель данных:**
```
Таблица Users:
| id | name  | email           |
|----|-------|-----------------|
| 1  | Иван  | ivan@mail.com   |
| 2  | Мария | maria@mail.com  |

Таблица Orders:
| id | user_id | amount |
|----|---------|--------|
| 1  | 1       | 1000   |
| 2  | 2       | 2000   |

Связь: Orders.user_id → Users.id
```

**Преимущества:**
- ✅ Гарантированная консистентность (ACID)
- ✅ Сложные запросы с JOIN
- ✅ Зрелые технологии и инструменты
- ✅ Стандартизированный SQL
- ✅ Поддержка транзакций

**Недостатки:**
- ❌ Ограниченная горизонтальная масштабируемость
- ❌ Жесткая схема (сложно изменять)
- ❌ Может быть медленнее для больших объемов
- ❌ Не подходит для неструктурированных данных

**Примеры:**
- **PostgreSQL** — продвинутая open-source БД
- **MySQL** — популярная для веб-приложений
- **Oracle Database** — enterprise решение
- **SQL Server** — Microsoft решение
- **SQLite** — встраиваемая БД

**Когда использовать:**
- ✅ Структурированные данные со связями
- ✅ Критична консистентность (финансы, заказы)
- ✅ Сложные запросы с JOIN
- ✅ Транзакции и ACID требования
- ✅ Традиционные веб-приложения

---

## Нереляционные базы данных (NoSQL)

### Определение

**NoSQL** (Not Only SQL) — это широкий класс баз данных, которые не используют реляционную модель данных. Оптимизированы для масштабируемости и производительности.

**Характеристики:**
- ✅ Гибкая схема данных
- ✅ Горизонтальная масштабируемость
- ✅ Высокая производительность
- ✅ Различные модели данных
- ⚠️ Обычно eventual consistency (не ACID)

---

## 1. Документные базы данных

### Определение

**Документная база данных** хранит данные в виде документов (обычно JSON, BSON, XML), где каждый документ может иметь свою структуру.

**Модель данных:**
```json
{
  "_id": "1",
  "name": "Иван",
  "email": "ivan@mail.com",
  "orders": [
    {"id": 1, "amount": 1000},
    {"id": 2, "amount": 2000}
  ],
  "address": {
    "city": "Москва",
    "street": "Ленина, 1"
  }
}
```

**Характеристики:**
- ✅ Гибкая схема (каждый документ может отличаться)
- ✅ Вложенные структуры
- ✅ Быстрые запросы по документу
- ✅ Хорошо для иерархических данных

**Преимущества:**
- ✅ Естественное представление данных (JSON)
- ✅ Быстрая разработка (без миграций схемы)
- ✅ Хорошая производительность чтения
- ✅ Подходит для контент-систем

**Недостатки:**
- ❌ Сложные JOIN операции
- ❌ Ограниченная поддержка транзакций
- ❌ Дублирование данных
- ❌ Может быть неэффективно для сложных связей

**Примеры:**
- **MongoDB** — самая популярная документная БД
- **CouchDB** — с multi-master репликацией
- **DynamoDB** — AWS managed документная БД
- **Firestore** — Google документная БД

**Когда использовать:**
- ✅ Контент-системы (блоги, CMS)
- ✅ Каталоги товаров
- ✅ Профили пользователей
- ✅ Данные с вложенной структурой
- ✅ Быстрое прототипирование

---

## 2. Key-Value базы данных

### Определение

**Key-Value база данных** хранит данные как пары ключ-значение, где ключ уникален, а значение может быть любым.

**Модель данных:**
```
Ключ: "user:123"
Значение: {"name": "Иван", "email": "ivan@mail.com"}

Ключ: "session:abc"
Значение: "user_id:123, expires:2024-01-01"

Ключ: "counter:views"
Значение: 1000
```

**Характеристики:**
- ✅ Простейшая модель данных
- ✅ Очень быстрые операции чтения/записи
- ✅ Минимальная задержка (low latency)
- ✅ Простота использования

**Преимущества:**
- ✅ Максимальная производительность
- ✅ Простота масштабирования
- ✅ Идеально для кэширования
- ✅ Низкая задержка

**Недостатки:**
- ❌ Нет сложных запросов
- ❌ Нет связей между данными
- ❌ Ограниченная функциональность
- ❌ Значение — это "черный ящик"

**Примеры:**
- **Redis** — in-memory key-value store
- **DynamoDB** — AWS key-value БД
- **Riak** — распределенная key-value БД
- **Memcached** — распределенный кэш

**Когда использовать:**
- ✅ Кэширование данных
- ✅ Сессии пользователей
- ✅ Счетчики и метрики
- ✅ Очереди сообщений
- ✅ Временные данные

---

## 3. Колоночные базы данных

### Определение

**Колоночная база данных** хранит данные по столбцам, а не по строкам, что оптимизирует аналитические запросы.

**Модель данных:**
```
Традиционная (по строкам):
| id | name  | age | city    |
|----|-------|-----|---------|
| 1  | Иван  | 25  | Москва  |
| 2  | Мария | 30  | СПб     |

Колоночная (по столбцам):
Столбец id:    [1, 2]
Столбец name:  [Иван, Мария]
Столбец age:   [25, 30]
Столбец city:  [Москва, СПб]
```

**Характеристики:**
- ✅ Оптимизирована для аналитики
- ✅ Сжатие данных (похожие значения в столбце)
- ✅ Быстрые агрегации (SUM, COUNT, AVG)
- ✅ Эффективна для больших объемов

**Преимущества:**
- ✅ Отличная производительность для аналитики
- ✅ Высокое сжатие данных
- ✅ Быстрые агрегации по столбцам
- ✅ Подходит для больших данных

**Недостатки:**
- ❌ Медленные обновления отдельных записей
- ❌ Не подходит для транзакционных операций
- ❌ Сложнее для простых запросов по одной записи
- ❌ Обычно eventual consistency

**Примеры:**
- **Cassandra** — распределенная колоночная БД
- **HBase** — колоночная БД на Hadoop
- **Bigtable** — Google колоночная БД
- **ScyllaDB** — высокопроизводительная Cassandra

**Когда использовать:**
- ✅ Аналитика и отчетность
- ✅ Большие объемы данных (Big Data)
- ✅ Data warehousing
- ✅ Временные ряды (метрики, логи)
- ✅ Агрегации и аналитические запросы

---

## 4. Графовые базы данных

### Определение

**Графовая база данных** хранит данные в виде узлов (nodes) и связей (edges), оптимизирована для работы с графами и связями.

**Модель данных:**
```
Узлы (Nodes):
  - Пользователь: {id: 1, name: "Иван"}
  - Пользователь: {id: 2, name: "Мария"}
  - Товар: {id: 101, name: "Книга"}

Связи (Edges):
  - Иван → ДРУЖИТ_С → Мария
  - Иван → КУПИЛ → Книга
  - Мария → РЕКОМЕНДУЕТ → Книга
```

**Характеристики:**
- ✅ Оптимизирована для связей
- ✅ Быстрые запросы по графу
- ✅ Естественное представление связей
- ✅ Сложные запросы по связям

**Преимущества:**
- ✅ Отличная производительность для связей
- ✅ Естественное представление сложных связей
- ✅ Быстрые запросы по графу (traversal)
- ✅ Подходит для социальных сетей

**Недостатки:**
- ❌ Не подходит для простых данных
- ❌ Ограниченная поддержка агрегаций
- ❌ Меньше инструментов и экосистемы
- ❌ Может быть сложнее для простых use cases

**Примеры:**
- **Neo4j** — самая популярная графовая БД
- **Amazon Neptune** — AWS managed графовая БД
- **ArangoDB** — мультимодельная (документы + графы)
- **JanusGraph** — распределенная графовая БД

**Когда использовать:**
- ✅ Социальные сети (друзья, подписки)
- ✅ Рекомендательные системы
- ✅ Fraud detection (обнаружение мошенничества)
- ✅ Knowledge graphs
- ✅ Сложные связи между сущностями

---

## 5. Базы данных временных рядов

### Определение

**База данных временных рядов** оптимизирована для хранения и запросов данных с временными метками (time-series data).

**Модель данных:**
```
Метрика: temperature
Временные ряды:
  2024-01-01 10:00:00 → 20°C
  2024-01-01 10:01:00 → 21°C
  2024-01-01 10:02:00 → 19°C
  ...

Метрика: cpu_usage
Временные ряды:
  2024-01-01 10:00:00 → 45%
  2024-01-01 10:01:00 → 50%
  ...
```

**Характеристики:**
- ✅ Оптимизирована для временных меток
- ✅ Эффективное сжатие временных рядов
- ✅ Быстрые запросы по времени
- ✅ Автоматическое удаление старых данных (retention)

**Преимущества:**
- ✅ Отличная производительность для временных рядов
- ✅ Эффективное сжатие
- ✅ Специализированные функции (downsampling, aggregation)
- ✅ Автоматическое управление данными

**Недостатки:**
- ❌ Специализированная БД (не универсальная)
- ❌ Ограниченная функциональность вне временных рядов
- ❌ Меньше инструментов

**Примеры:**
- **InfluxDB** — популярная БД временных рядов
- **TimescaleDB** — расширение PostgreSQL для временных рядов
- **Prometheus** — мониторинг и метрики
- **OpenTSDB** — распределенная БД временных рядов

**Когда использовать:**
- ✅ IoT данные (сенсоры, устройства)
- ✅ Мониторинг и метрики
- ✅ Аналитика временных рядов
- ✅ Финансовые данные (котировки)
- ✅ Логи с временными метками

---

## 6. Поисковые базы данных

### Определение

**Поисковая база данных** оптимизирована для полнотекстового поиска и индексации документов.

**Характеристики:**
- ✅ Полнотекстовый поиск
- ✅ Инвертированные индексы
- ✅ Ранжирование результатов
- ✅ Анализ текста (tokenization, stemming)

**Преимущества:**
- ✅ Отличный полнотекстовый поиск
- ✅ Быстрый поиск по большим объемам текста
- ✅ Ранжирование и релевантность
- ✅ Поддержка сложных запросов

**Недостатки:**
- ❌ Специализированная БД
- ❌ Не подходит для транзакционных операций
- ❌ Обычно eventual consistency

**Примеры:**
- **Elasticsearch** — популярная поисковая БД
- **Solr** — Apache поисковая БД
- **OpenSearch** — форк Elasticsearch
- **Meilisearch** — быстрая поисковая БД

**Когда использовать:**
- ✅ Поиск по продуктам
- ✅ Поиск по документам
- ✅ Логирование и анализ логов
- ✅ Аналитика и визуализация
- ✅ Полнотекстовый поиск

---

## Сравнительная таблица

| Тип БД | Модель данных | Масштабируемость | Консистентность | Use Cases |
|--------|---------------|------------------|-----------------|-----------|
| **Реляционная** | Таблицы со связями | Вертикальная | ACID (strong) | Финансы, заказы, CRM |
| **Документная** | JSON документы | Горизонтальная | Eventual | Контент, каталоги, профили |
| **Key-Value** | Ключ-значение | Горизонтальная | Eventual | Кэш, сессии, счетчики |
| **Колоночная** | Столбцы | Горизонтальная | Eventual | Аналитика, Big Data |
| **Графовая** | Узлы и связи | Горизонтальная | Eventual | Соцсети, рекомендации |
| **Временные ряды** | Временные метки | Горизонтальная | Eventual | IoT, мониторинг, метрики |
| **Поисковая** | Индексированные документы | Горизонтальная | Eventual | Поиск, логи, аналитика |

---

## Выбор типа базы данных

### Реляционная (SQL)

**Выбирайте когда:**
- ✅ Структурированные данные со связями
- ✅ Критична консистентность (ACID)
- ✅ Сложные запросы с JOIN
- ✅ Транзакции
- ✅ Традиционные приложения

**Примеры:**
- Банковские системы
- E-commerce (заказы, платежи)
- CRM системы
- ERP системы

---

### Документная

**Выбирайте когда:**
- ✅ Гибкая схема данных
- ✅ Вложенные структуры
- ✅ Контент-системы
- ✅ Быстрое прототипирование

**Примеры:**
- Блоги и CMS
- Каталоги товаров
- Профили пользователей
- Конфигурации

---

### Key-Value

**Выбирайте когда:**
- ✅ Кэширование
- ✅ Сессии
- ✅ Счетчики
- ✅ Временные данные

**Примеры:**
- Кэш приложений
- Сессии пользователей
- Счетчики просмотров
- Очереди сообщений

---

### Колоночная

**Выбирайте когда:**
- ✅ Аналитика и отчетность
- ✅ Большие объемы данных
- ✅ Агрегации
- ✅ Data warehousing

**Примеры:**
- Аналитические системы
- Big Data приложения
- Data warehouses
- Метрики и логи

---

### Графовая

**Выбирайте когда:**
- ✅ Сложные связи между сущностями
- ✅ Социальные сети
- ✅ Рекомендательные системы
- ✅ Fraud detection

**Примеры:**
- Социальные сети
- Рекомендательные системы
- Knowledge graphs
- Обнаружение мошенничества

---

### Временные ряды

**Выбирайте когда:**
- ✅ Данные с временными метками
- ✅ IoT и сенсоры
- ✅ Мониторинг
- ✅ Метрики

**Примеры:**
- IoT платформы
- Системы мониторинга
- Финансовые котировки
- Аналитика метрик

---

### Поисковая

**Выбирайте когда:**
- ✅ Полнотекстовый поиск
- ✅ Поиск по большим объемам
- ✅ Анализ логов
- ✅ Поиск по продуктам

**Примеры:**
- Поиск по продуктам
- Поиск по документам
- Анализ логов
- Поисковые системы

---

## Полиглотное хранение (Polyglot Persistence)

### Определение

**Полиглотное хранение** — использование разных типов баз данных в одной системе для разных задач.

**Принцип:**
> Используйте правильный инструмент для правильной задачи.

**Пример архитектуры:**
```
E-commerce система:

PostgreSQL (реляционная):
  - Заказы
  - Платежи
  - Пользователи (критичные данные)

MongoDB (документная):
  - Каталог товаров
  - Профили пользователей
  - Контент

Redis (key-value):
  - Кэш товаров
  - Сессии
  - Счетчики просмотров

Elasticsearch (поисковая):
  - Поиск по товарам
  - Аналитика

InfluxDB (временные ряды):
  - Метрики производительности
  - Аналитика продаж
```

**Преимущества:**
- ✅ Оптимальный инструмент для каждой задачи
- ✅ Лучшая производительность
- ✅ Масштабируемость
- ✅ Гибкость

**Недостатки:**
- ❌ Сложность управления
- ❌ Больше компонентов
- ❌ Нужна синхронизация между БД
- ❌ Сложнее разработка

---

## Резюме

**Ключевые моменты:**

1. ✅ **Реляционные БД** — для структурированных данных с ACID требованиями
2. ✅ **Документные БД** — для гибких схем и контента
3. ✅ **Key-Value БД** — для кэширования и простых операций
4. ✅ **Колоночные БД** — для аналитики и Big Data
5. ✅ **Графовые БД** — для сложных связей
6. ✅ **Временные ряды** — для данных с временными метками
7. ✅ **Поисковые БД** — для полнотекстового поиска

**Правило выбора:**

- **SQL (реляционные)** — когда нужна консистентность и сложные запросы
- **NoSQL** — когда нужна масштабируемость и производительность
- **Полиглотное хранение** — используйте разные БД для разных задач

**Помните:** Нет универсального решения. Выбор зависит от конкретных требований, объема данных, паттернов доступа и требований к консистентности.

